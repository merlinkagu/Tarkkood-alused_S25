alpha = 0.15, size = 1.8, show.legend = FALSE
) +
# Mediaani esiletõstmine (valikuline, aitab tõlgendamisel)
stat_summary(
fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black"
) +
guides(fill = "none", color = "none") +
labs(
title = "Ravimi mõju mälule: Diff jaotused ravimi (Drug) lõikes",
subtitle = "Violin = jaotuse tihedus; must rist = mediaan; punktid = üksikosalejad (väga heledad, jitter)",
x = "Ravim (Drug)",
y = "Mälu muutus (Diff = After - Before)"
) +
theme_minimal(base_size = 12)
Isd %>%
filter(!is.na(Drug), !is.na(Diff)) %>%
ggplot(aes(x = Drug, y = Diff, fill = Drug)) +
# Jaotuse kuju (tihedus)
geom_violin(trim = FALSE, alpha = 0.6, color = NA) +
# Väga heledad üksikpunktid, jitter, et kattumist vähendada
geom_point(
aes(color = Drug),
position = position_jitter(width = 0.15, height = 0, seed = 1),
alpha = 0.15, size = 1.8, show.legend = FALSE
) +
# Mediaani esiletõstmine
stat_summary(
fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black"
) +
guides(fill = "none", color = "none") +
labs(
title = "Ravimi mõju mälule: Diff jaotused ravimi (Drug) lõikes",
subtitle = "Violin = jaotuse tihedus; must joon = mediaan; punktid = üksikosalejad (väga heledad, jitter)",
x = "Ravim (Drug)",
y = "Mälu muutus (Diff = After - Before)"
) +
theme_minimal(base_size = 12)
Isd %>%
filter(!is.na(Drug), !is.na(Diff)) %>%
ggplot(aes(x = Drug, y = Diff, fill = Drug)) +
# Jaotuse kuju (tihedus)
geom_violin(trim = FALSE, alpha = 0.6, color = NA) +
# Väga heledad üksikpunktid, jitter, et kattumist vähendada
geom_point(
aes(color = Drug),
position = position_jitter(width = 0.15, height = 0, seed = 1),
alpha = 0.5, size = 1.8, show.legend = FALSE
) +
# Mediaani esiletõstmine
stat_summary(
fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black"
) +
guides(fill = "none", color = "none") +
labs(
title = "Ravimi mõju mälule: Diff jaotused ravimi (Drug) lõikes",
subtitle = "Violin = jaotuse tihedus; must joon = mediaan; punktid = üksikosalejad (väga heledad, jitter)",
x = "Ravim (Drug)",
y = "Mälu muutus (Diff = After - Before)"
) +
theme_minimal(base_size = 12)
Isd %>%
filter(!is.na(Drug), !is.na(Diff)) %>%
ggplot(aes(x = Drug, y = Diff, fill = Drug)) +
# Jaotuse kuju (tihedus)
geom_violin(trim = FALSE, alpha = 0.6, color = NA) +
# Üksikpunktid, jitter, et kattumist vähendada
geom_point(
aes(color = Drug),
position = position_jitter(width = 0.15, height = 0, seed = 1),
alpha = 0.5, size = 1.8, show.legend = FALSE
) +
# Mediaani esiletõstmine
stat_summary(
fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black"
) +
guides(fill = "none", color = "none") +
labs(
title = "Ravimi mõju mälule: Diff jaotused ravimi (Drug) lõikes",
subtitle = "Violin = jaotuse tihedus; must joon = mediaan; punktid = üksikosalejad",
x = "Ravim (Drug)",
y = "Mälu muutus (Diff = After - Before)"
) +
theme_minimal(base_size = 12)
# Hajuvusdiagramm logaritmilise y-teljega mtcars andmetel
scatter_plot_scaled <- ggplot(mtcars, aes(x = mpg, y = hp)) +
geom_point(alpha = 0.5) +
scale_y_log10()
scatter_plot_scaled
# Arvuta iga silindrite kategooria mediaan mpg
cyl_median <- mtcars %>%
group_by(cyl) %>%
summarize(median_mpg = median(mpg, na.rm = TRUE)) %>%
arrange(median_mpg)
cyl_median
# Kastdiagramm ümberjärjestatud silindrite kategooriatega
box_plot_scaled <- ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
geom_boxplot() +
scale_x_discrete(limits = factor(cyl_median$cyl)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
xlab("Silindrite arv")
box_plot_scaled
# Kastdiagramm ümberjärjestatud silindrite kategooriatega ja värviskaalaga
box_plot_color_scaled <- ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
geom_boxplot(alpha = 0.4, outlier.shape = NA) +  # täitmine disp järgi
geom_jitter(aes(color = disp), width = 0.3) +  # hajutatud punktid värvitud disp järgi
scale_x_discrete(limits = factor(cyl_median$cyl)) +
scale_color_gradient(low = "blue", high = "red") +  # värviskaala punktidele
theme(axis.text.x = element_text(angle = 45, hjust = 1))
box_plot_color_scaled
# Laadi vajalikud paketid
library(forcats)
# # Kodeeri Drug muutuja ümber
Isd_refactored <- Isd %>%
mutate(Drug_name = fct_recode(Drug,
"Alprazolam" = "A",
"Triazolam" = "T",
"Suhkur" = "S"))
head(Isd_refactored)
# Loo uus veerg, kus Drug_name on ümberjärjestatud Diff väärtuse järgi
Isd_reordered <- Isd_refactored %>%
mutate(Drug_reordered = fct_reorder(Drug_name, Diff, .fun = max, .desc = TRUE))
head(Isd_reordered)
# Tulpdiagramm ümberjärgestatud Drug ja Happy_Sad_group muutujatega
bar_plot_reordered <- ggplot(Isd_reordered, aes(x = Drug_reordered, fill = Happy_Sad_group)) +
geom_bar(position = "dodge") +
labs(x = "Ravim (ümberjärgestatud)", fill = "Õnnelik/Kurb rühm") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
bar_plot_reordered
# Hajuvusdiagramm Sepal.Length vs Sepal.Width ja Petal.Length värviskaalana
scatter_plot_example <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Petal.Length)) +
geom_point(alpha = 0.7) +
scale_color_continuous(low = "blue", high = "red") +
theme_minimal()
scatter_plot_example
# Lisa pealkiri, alapealkiri ja teljesildid
scatter_plot_labeled <- scatter_plot_example +
labs(
title = "Õielehe pikkus vs. Õielehe laius",
subtitle = "Värvitud õielehe pikkuse järgi",
x = "Õielehe pikkus",
y = "Õielehe laius",
color = "Õielehe pikkus"
)
scatter_plot_labeled
# Määra x- ja y-telje piirid
scatter_plot_limited <- scatter_plot_labeled +
xlim(4, 8) +
ylim(2, 4) +
geom_point(mapping = aes(size = Petal.Width), alpha=0.4) +
labs(size = 'Õielehe laius')
scatter_plot_limited
scatter_plot_custom_theme <- scatter_plot_limited +
theme(
plot.title = element_text(size = 18, face = "bold"),
plot.subtitle = element_text(size = 14),
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.5),
panel.grid.minor = element_line(color = "gray", linetype = "dotted", linewidth = 0.25)
)
scatter_plot_custom_theme
# Salvesta joonis PNG-failina
ggsave(
filename = "scatter_plot_custom_theme.png",
plot = scatter_plot_custom_theme,
width = 8,
height = 5,
dpi = 300
)
# Salvesta joonis PDF-failina
ggsave(
filename = "scatter_plot_custom_theme.pdf",
width = 8,
height = 5
)
# Laadi vajalikud paketid
# library(ggplot2)
library(patchwork)
# Hajuvusdiagramm mpg vs. wt
scatter_plot <- ggplot(mtcars, aes(x = wt, y = mpg)) +
geom_point(aes(color = cyl)) +
labs(title = "Kütusesäästlikkus vs. kaal", x = "Kaal (1000 lbs)", y = "Kütusesäästlikkus", color = "Silindrid") +
theme_minimal()
# Tulpdiagramm autode arvust silindrite kaupa
bar_plot <- ggplot(mtcars, aes(x = factor(cyl))) +
geom_bar(aes(fill = factor(cyl))) +
labs(title = "Autode arv silindrite kaupa", x = "Silindrite arv", y = "Arv", fill = "Silindrid") +
theme_minimal()
# Kastdiagramm mpg silindrite kaupa
box_plot <- ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
geom_boxplot(aes(fill = factor(cyl))) +
labs(title = "Kütusesäästlikkus silindrite kaupa", x = "Silindrite arv", y = "Kütusesäästlikkus", fill = "Silindrid") +
theme_minimal() + theme(legend.position = "None")
# Kombineeri joonised patchwork abil
combined_plot <- scatter_plot + bar_plot + box_plot + plot_layout(ncol = 1)
combined_plot
# Kogu legendid ja lisa globaalne pealkiri, alapealkiri ja allkiri
combined_plot_annotated <- scatter_plot / (bar_plot + box_plot) +
plot_annotation(
title = "mtcars andmestiku uurimine",
subtitle = "Hajuvusdiagramm, tulpdiagramm ja kastdiagramm",
caption = "Andmeallikas: mtcars",
tag_levels = 'A'
) +
plot_layout(guides = "collect")
combined_plot_annotated
p1 <- df |>
ggplot(aes(x = Diff, fill = Drug)) +
geom_histogram(bins = 30, alpha = 0.8, color = "white") +
geom_vline(aes(xintercept = 0), linetype = 3) +
labs(title = "Diff jaotus", x = "Diff (After - Before)", y = "Kordused") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
ggplot(aes(x = Diff, fill = Drug)) +
geom_histogram(bins = 30, alpha = 0.8, color = "white") +
geom_vline(aes(xintercept = 0), linetype = 3) +
labs(title = "Diff jaotus", x = "Diff (After - Before)", y = "Kordused") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p1 <- Isd_refactored %>%
ggplot(aes(x = Diff, fill = Drug)) +
geom_histogram(bins = 30, alpha = 0.8, color = "white") +
geom_vline(aes(xintercept = 0), linetype = 3) +
labs(title = "Diff jaotus", x = "Diff (After - Before)", y = "Kordused") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p1
p1 <- Isd %>%
ggplot(aes(x = Diff, fill = Drug)) +
geom_histogram(bins = 30, alpha = 0.8, color = "white") +
geom_vline(aes(xintercept = 0), linetype = 3) +
labs(title = "Diff jaotus", x = "Diff (After - Before)", y = "Kordused") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p1
p2 <- Isd_refactored %>%
ggplot(aes(x = Mem_Score_Before, y = Mem_Score_After, color = Drug)) +
geom_abline(slope = 1, intercept = 0, linetype = 3) +
geom_point(alpha = 0.35, size = 1.8) +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Enne vs Pärast", x = "Before", y = "After") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p2
p3 <- Isd_refactored %>%
filter(!is.na(Drug), !is.na(Diff)) |>
ggplot(aes(x = Drug, y = Diff, fill = Drug)) +
geom_violin(trim = FALSE, alpha = 0.7, color = NA) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black") +
geom_jitter(aes(color = Drug), width = 0.12, height = 0, alpha = 0.18, size = 1.7, show.legend = FALSE) +
labs(title = "Diff jaotused ravimi lõikes", x = "Drug", y = "Diff") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
set.seed(1)
p3 <- Isd_refactored %>%
filter(!is.na(Drug), !is.na(Diff)) |>
ggplot(aes(x = Drug, y = Diff, fill = Drug)) +
geom_violin(trim = FALSE, alpha = 0.7, color = NA) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, fatten = 0, color = "black") +
geom_jitter(aes(color = Drug), width = 0.12, height = 0, alpha = 0.18, size = 1.7, show.legend = FALSE) +
labs(title = "Diff jaotused ravimi lõikes", x = "Drug", y = "Diff") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p3
p4 <- Isd_refactored %>%
ggplot(aes(x = Dosage, y = Diff, group = Drug, color = Drug)) +
stat_summary(fun = median, geom = "line", position = position_dodge(width = 0.35)) +
stat_summary(fun = median, geom = "point", size = 2.2, position = position_dodge(width = 0.35)) +
labs(title = "Doosi-efekt (mediaan Diff)", x = "Dosage", y = "Diff (mediaan)") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p4
p4
p5 <- Isd_refactored %>%
ggplot(aes(x = age, y = Diff, color = Drug)) +
geom_point(alpha = 0.15, size = 1.4) +
geom_smooth(se = FALSE, span = 0.9) +
labs(title = "Vanuse seos Diff-iga", x = "Age", y = "Diff") +
theme_minimal(base_size = 12) +
theme(legend.position = "none")
p5
# paneelide sildid
p1L <- p1 + labs(subtitle = "A) Diff jaotus (kõik ravimid)")
p2L <- p2 + labs(subtitle = "B) Before vs After (diagonaal = sama tase)")
p3L <- p3 + labs(subtitle = "C) Diff jaotused ravimi järgi (violin + mediaan)")
p4L <- p4 + labs(subtitle = "D) Doosi mõju (mediaan Diff)")
p5L <- p5 + labs(subtitle = "E) Vanuse trend (LOESS)")
final_plot <- (p1L | p2L) /
(p3L | p4L) /
p5L +
plot_annotation(
title = "Drugged Islanders: Mälu muutuse (Diff) visuaalne profiil",
subtitle = "A–B: üldpilt; C: jaotus ravimi lõikes; D: doosi-efekt; E: vanuse trend",
caption = "Legend eemaldatud; toonid vastavad ravimi gruppidele igas paneelis."
)
final_plot
# {r fig.width=11, fig.height=7}
library(tidyverse)
library(patchwork)
library(viridis)   # värvipalett
df <- Isd |> drop_na(Drug, Diff)
# ---- ühtne teema + palett ----
theme_pub <- theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0),
plot.subtitle = element_text(color = "grey30", margin = margin(b = 6)),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
strip.background = element_rect(fill = "grey95", color = NA),
strip.text = element_text(face = "bold"),
legend.position = "none",
plot.margin = margin(10, 12, 10, 12)
)
pal <- viridis(n = length(unique(df$Drug)), option = "D", begin = .1, end = .9)
# ---- A) jaotus ravimi lõikes (puhtam violin + väga hele jitter) ----
set.seed(2)
pA <- ggplot(df, aes(x = Drug, y = Diff, fill = Drug, color = Drug)) +
geom_violin(trim = FALSE, alpha = 0.85, color = NA, width = .9) +
stat_summary(fun = median, geom = "crossbar", width = .5, fatten = 0, color = "grey10") +
geom_jitter(width = .12, height = 0, alpha = .12, size = 1.6) +
scale_fill_manual(values = pal) +
scale_color_manual(values = pal) +
labs(title = "Mälu muutus (Diff) ravimi lõikes",
x = NULL, y = "Diff (After - Before)") +
theme_pub
# ---- B) doosiefekt (mediaan Diff; selged jooned ja punktid) ----
summ <- df |>
group_by(Drug, Dosage) |>
summarise(med = median(Diff, na.rm = TRUE), .groups = "drop")
pB <- ggplot(summ, aes(x = Dosage, y = med, group = Drug, color = Drug)) +
geom_line(linewidth = 1) +
geom_point(size = 2.6, stroke = 0) +
scale_color_manual(values = pal) +
labs(title = "Doosi mõju (mediaan Diff)", x = "Dosage", y = "Diff (mediaan)") +
theme_pub
# ---- C) vanuse trend (väga kerged punktid + LOESS, ilma varjuta) ----
pC <- ggplot(df, aes(x = age, y = Diff, color = Drug)) +
geom_point(alpha = .10, size = 1.2) +
geom_smooth(se = FALSE, linewidth = 1.1, span = .9) +
scale_color_manual(values = pal) +
labs(title = "Vanuse trend Diff-ile", x = "Age", y = "Diff") +
theme_pub
# ---- lõppkoost (legendita, ühtlane hingamine) ----
final <- pA | (pB / pC) +
plot_annotation(
title = "Drugged Islanders: mälu muutuse profiil (legendita)",
subtitle = "Vasak: jaotus ravimi lõikes; Üleval parem: doosi efekt; All parem: vanuse trend",
caption = "Värvid on püsivad üle paneelide; läbipaistvad punktid vähendavad ülejoonistamist."
)
final
# ggsave("islander_clean_pub_fig.png", final, width = 11, height = 7, dpi = 320)
```{# {r fig.width=11, fig.height=9}
df <- Isd |>
drop_na(Drug, Diff) |>
mutate(Dosage = as.factor(Dosage))  # ainult kui tahad kategoorilist telge
# ühtne, puhas teema
theme_pub <- theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0),
plot.subtitle = element_text(color = "grey30", margin = margin(b = 6)),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
legend.position = "none",
strip.background = element_rect(fill = "grey95", color = NA),
strip.text = element_text(face = "bold")
)
# --- A) Diff jaotus ravimi sees (violin + väga hele jitter) ---
set.seed(2)
pA <- ggplot(df, aes(x = Drug, y = Diff)) +
geom_violin(fill = "#5DA5DA", alpha = .9, color = NA, width = .9, trim = FALSE) +
stat_summary(fun = median, geom = "crossbar", width = .5, fatten = 0, color = "grey10") +
geom_jitter(width = .12, height = 0, alpha = .12, size = 1.6) +
facet_wrap(~ Drug, nrow = 1, scales = "free_x") +
labs(title = "Mälu muutus (Diff) – jaotus ravimi sees",
x = NULL, y = "Diff (After - Before)") +
theme_pub +
theme(axis.text.x = element_blank())
# --- B) Doosi mõju (mediaan Diff) ravimi sees ---
summ <- df |>
group_by(Drug, Dosage) |>
summarise(med = median(Diff, na.rm = TRUE), .groups = "drop")
pB <- ggplot(summ, aes(x = Dosage, y = med, group = 1)) +
geom_line(linewidth = 1, color = "#F17CB0") +
geom_point(size = 2.6, stroke = 0, color = "#F17CB0") +
facet_wrap(~ Drug, nrow = 1) +
labs(title = "Doosi-efekt ravimi sees (mediaan Diff)",
x = "Dosage", y = "Diff (mediaan)") +
theme_pub
# --- C) Vanuse trend ravimi sees (hele hajuvus + LOESS) ---
pC <- ggplot(df, aes(x = age, y = Diff)) +
geom_point(alpha = .10, size = 1.2, color = "#60BD68") +
geom_smooth(se = FALSE, linewidth = 1.1, span = .9, color = "#60BD68") +
facet_wrap(~ Drug, nrow = 1) +
labs(title = "Vanuse seos Diff-iga (LOESS), ravimi sees",
x = "Age", y = "Diff") +
theme_pub
# --- lõppkoost: vertikaalne stack, legendita ---
final_facets <- pA / pB / pC +
plot_annotation(
title = "Drugged Islanders – Facetitega ülevaade (legendita)",
subtitle = "Ülal: jaotus; keskel: doosi-efekt; all: vanuse trend iga ravimi sees",
caption  = "Punktid väga läbipaistvad; mediaan rõhutatud."
)
final_facets
# ggsave("islander_facets_clean.png", final_facets, width = 11, height = 9, dpi = 320)
library(tidyverse)
library(patchwork)
library(viridis)   # värvipalett
df <- Isd |> drop_na(Drug, Diff)
# ---- ühtne teema + palett ----
theme_pub <- theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0),
plot.subtitle = element_text(color = "grey30", margin = margin(b = 6)),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
strip.background = element_rect(fill = "grey95", color = NA),
strip.text = element_text(face = "bold"),
legend.position = "none",
plot.margin = margin(10, 12, 10, 12)
)
pal <- viridis(n = length(unique(df$Drug)), option = "D", begin = .1, end = .9)
# ---- A) jaotus ravimi lõikes (puhtam violin + väga hele jitter) ----
set.seed(2)
pA <- ggplot(df, aes(x = Drug, y = Diff, fill = Drug, color = Drug)) +
geom_violin(trim = FALSE, alpha = 0.85, color = NA, width = .9) +
stat_summary(fun = median, geom = "crossbar", width = .5, fatten = 0, color = "grey10") +
geom_jitter(width = .12, height = 0, alpha = .12, size = 1.6) +
scale_fill_manual(values = pal) +
scale_color_manual(values = pal) +
labs(title = "Mälu muutus (Diff) ravimi lõikes",
x = NULL, y = "Diff (After - Before)") +
theme_pub
# ---- B) doosiefekt (mediaan Diff; selged jooned ja punktid) ----
summ <- df |>
group_by(Drug, Dosage) |>
summarise(med = median(Diff, na.rm = TRUE), .groups = "drop")
pB <- ggplot(summ, aes(x = Dosage, y = med, group = Drug, color = Drug)) +
geom_line(linewidth = 1) +
geom_point(size = 2.6, stroke = 0) +
scale_color_manual(values = pal) +
labs(title = "Doosi mõju (mediaan Diff)", x = "Dosage", y = "Diff (mediaan)") +
theme_pub
# ---- C) vanuse trend (väga kerged punktid + LOESS, ilma varjuta) ----
pC <- ggplot(df, aes(x = age, y = Diff, color = Drug)) +
geom_point(alpha = .10, size = 1.2) +
geom_smooth(se = FALSE, linewidth = 1.1, span = .9) +
scale_color_manual(values = pal) +
labs(title = "Vanuse trend Diff-ile", x = "Age", y = "Diff") +
theme_pub
# ---- lõppkoost (legendita, ühtlane hingamine) ----
final <- pA | (pB / pC) +
plot_annotation(
title = "Drugged Islanders: mälu muutuse profiil (legendita)",
subtitle = "Vasak: jaotus ravimi lõikes; Üleval parem: doosi efekt; All parem: vanuse trend",
caption = "Värvid on püsivad üle paneelide; läbipaistvad punktid vähendavad ülejoonistamist."
)
final
Isd_na <- Isd %>% drop_na(Drug, Diff)
theme_pub <- theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0),
plot.subtitle = element_text(color = "grey30", margin = margin(b = 6)),
axis.title = element_text(face = "bold"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
strip.background = element_rect(fill = "grey95", color = NA),
strip.text = element_text(face = "bold"),
legend.position = "none",
plot.margin = margin(10, 12, 10, 12)
)
pal <- viridis(n = length(unique(Isd_na$Drug)), option = "D", begin = .1, end = .9)
# jaotus ravimi lõikes
set.seed(2)
pA <- ggplot(Isd_na, aes(x = Drug, y = Diff, fill = Drug, color = Drug)) +
geom_violin(trim = FALSE, alpha = 0.85, color = NA, width = .9) +
stat_summary(fun = median, geom = "crossbar", width = .5, fatten = 0, color = "grey10") +
geom_jitter(width = .12, height = 0, alpha = .12, size = 1.6) +
scale_fill_manual(values = pal) +
scale_color_manual(values = pal) +
labs(title = "Mälu muutus (Diff) ravimi lõikes",
x = NULL, y = "Diff (After - Before)") +
theme_pub
# doosiefekt
summ <- Isd_na %>%
group_by(Drug, Dosage) %>%
summarise(med = median(Diff, na.rm = TRUE), .groups = "drop")
pB <- ggplot(summ, aes(x = Dosage, y = med, group = Drug, color = Drug)) +
geom_line(linewidth = 1) +
geom_point(size = 2.6, stroke = 0) +
scale_color_manual(values = pal) +
labs(title = "Doosi mõju (mediaan Diff)", x = "Dosage", y = "Diff (mediaan)") +
theme_pub
# vanuse trend
pC <- ggplot(Isd_na, aes(x = age, y = Diff, color = Drug)) +
geom_point(alpha = .10, size = 1.2) +
geom_smooth(se = FALSE, linewidth = 1.1, span = .9) +
scale_color_manual(values = pal) +
labs(title = "Vanuse trend Diff-ile", x = "Age", y = "Diff") +
theme_pub
# kokku liitmine üheks graafikuks
final <- pA | (pB / pC) +
plot_annotation(
title = "Drugged Islanders: mälu muutuse profiil (legendita)",
subtitle = "Vasak: jaotus ravimi lõikes; Üleval parem: doosi efekt; All parem: vanuse trend",
caption = "Värvid on püsivad üle paneelide; läbipaistvad punktid vähendavad ülejoonistamist."
)
final
